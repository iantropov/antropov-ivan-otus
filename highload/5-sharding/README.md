# ДЗ 5. Работа с шардированием

## Описание

Доработал приложение с прошлых ДЗ с целью поддержки диалогов и сообщений

Приложение разворачивается из docker-compose

## Про шардирование

В приложении присутствует возможность шардирования данных по диалогам. При такой схеме все данные конкретного диалога будут находится на одном шарде. Конкретный выбор схемы нужно будет делать после того, как система наполнится данными и будет понятно в какую сторону образуется перекос - какие аккаунты будут генерить большее число диалогов и как распределять нагрузку.

Выбронный инструмент позволяет также проводить решардинг. Допустим нам надо перенести диалог с одного шарда на другой:
- включается зеркалирование запросов на запись на старый и новый шард
- данные по диалогу перемещаются на новый шард
- отлючается зеркалирование на запись
- запись переключается только на новый шард

## Commands

```
mysql -uuser -p -P6032 -h 127.0.0.1 --prompt='Admin> '
mysql -uuser -p -P6033 -h 127.0.0.1 --prompt='Client> '

insert into mysql_query_rules(rule_id,active,match_pattern,destination_hostgroup,apply) values(4, 1, "e1b77b7e-49d7-48ee-a51e-edb1c6aafb06", 1, 1);
LOAD MYSQL QUERY RULES TO RUNTIME;

select * from stats_mysql_processlist;

select * from stats_mysql_prepared_statements_info;

```