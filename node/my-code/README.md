# Project Work: MyCode

## Deployment

Приложение развёрнуто в Heroku: https://otus-my-code.herokuapp.com/

В развёрнутом приложении используется MongoDB Atlas

## DevCycle

```
npm run start:dev
```

```
npm run build
NODE_ENV=production node dist/main
```

## Links

https://www.mongodb.com/blog/post/6-rules-of-thumb-for-mongodb-schema-design-part-1

## Roadmap

Сущности:
- User
  - id: number
  - name: string
  - email: sting
  - role: {id: number, name: role}
  - favouriteProblems: number[]
- Problem
  - id: number
  - categories: [{id: number, name: string}]
  - description: string
  - summary: string
  - solution: string

Админ заводится при старте системы

Use Cases:
- Регистрация пользователя
- Логин пользователя
- Под админом:
  - просмотр категорий
  - просмотр пользователей
  - удаление пользователей
  - просмотр задач
  - добавление задач
  - редактирование задач
  - удаление задач
  - добавление в избранные
  - удаление из избранного
- Под пользователем
  - Просмотр задач
  - добавление в избранное
  - удаление из избранного

Roadmap:
- бэкенд
  + сделать скелет проекта
  + завести пользователей
  + завести задачи
  + подключить GraphQL
  + сделать резолверы
  + сделать аутентификацию/авторизацию через jwt и заголовки
  + сделать логаут
  + добавить любимые задачи
  + добавить категории
  + реализовать поиск задач
  - закрыть роуты гардами
  - добавить валидаций
  - обработка невалидного ID (например, 1)
  - обработка ошибок GraphQL
  - валидация на уникальный email
  - сделать solution опциональным
  - добавить логирование БД и посмотреть на запросы связей
  - убрать JWT_SECRET в окружение
  -? добавить хранение сессий в редис
  -? добавить протухание сессий (ttl)
- фронтенд
  + завести фронт на nextjs
  + подключить apollo client
  + сделать страницу логина
  + сделать логаут
  + подключить bootstrap
  + сделать layout приложения
  + завезти заголовок дологина
  + завезти заголовок залогина
  + сделать футер
  + сделать страницу регистрации
  + сделать страницу задач
    - https://getbootstrap.com/docs/5.2/examples/list-groups/#
    - https://getbootstrap.com/docs/5.2/components/collapse/
  + сделать страницу любимых задач
  + сделать заголовок админа
  + сделать страницу пользовалей
  + сделать удаление пользователя
  + сделать добавление задачи
  + сделать страницу редактирования задачи
  + сделать удаление задачи
  + переверстать компонент задачи
  + сделать лайк
  + доделать создание задач с категориями
  + доделать вывод задач с категориями
  + добавить текстовый поиск по задачам
  + добавить поиск по категориям задач
  + завести компонент Main
  + переделать потоки данных (мутации только в компонентах-контейнерах)
  + добавить пагинацию
  - редактирование права на Админа
  - добавить валидаций
  - централизовать обработку ошибок apollo (error-link)
  - добавить подтверждение удалений
  - порефакторить мультиселект
  - добавить всплывашки об успехе операций
  - отказаться от _id в пользу id на фронте
+ Деплой (в качестве последней домашки):
  + подключение mongodb через Mongo Atlas
  + Регистрация на Heroku
  + деплой приложения
- Тестирование
  - Тесты на бэке
    - in-memory database
  - Тесты на фронт
    - e2e тесты на Playwright


=================================

```
show databases;
use my-code;
db.users.updateOne({_id: ObjectId("63635a5ac773205aea27306c")}, {$set:{isAdmin: true}})
```